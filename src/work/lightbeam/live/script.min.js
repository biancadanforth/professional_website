function lightbeamVis(){let visitedSites={'amazon.com':{},'facebook.com':{},'google.com':{},'youtube.com':{}};let thirdPartySpan=document.getElementById("third-party-site");let thirdPartyAboutSpan=document.getElementById("third-party-site-about");let visitedSiteSpan=document.getElementById("visited-site");let dataSentSpan=document.getElementById('data-sent');let prevPathElement;let sidePanel=document.getElementById('side-panel');let pathElements=[];let pathSVGElements=document.getElementsByClassName('site');for(let k=0;k<pathSVGElements.length;k+=1){pathElements.push(pathSVGElements[k].getElementsByTagName('path'))}pathElements=pathElements.reduce(function(a,b){return[...a,...b]},[]);for(let l=0;l<pathElements.length;l+=1){pathElements[l].addEventListener('click',function(){updateSideBar(pathElements[l])})}const backToTop=document.getElementById('back-to-top');backToTop.onclick=scrollToTop;function scrollToTop(){window.scrollTo(0,0)}document.body.addEventListener('click',deselectSlice,true);function deselectSlice(e){if(e.target.id.indexOf('chart')===-1){for(let m=0;m<pathElements.length;m+=1){pathElements[m].classList.remove('active')}}}let closeButton=document.getElementById('close');closeButton.onclick=closeSideBar;function closeSideBar(){sidePanel.classList.add('hidden');scrollToTop()}loadJSON();function loadJSON(){var xobj=new XMLHttpRequest();xobj.overrideMimeType("application/json");xobj.open('GET','lightbeamData.json',true);xobj.onreadystatechange=function(){if(xobj.readyState==4&&xobj.status=="200"){init(xobj.responseText)}};xobj.send(null)}function init(response){var data=JSON.parse(response);for(let currentSite in visitedSites){let dataSent=0;for(let j=0;j<data.length;j+=1){let source=data[j][0];let target=data[j][1];let arrayOfStrings=target.split('.');if(arrayOfStrings.length>2){arrayOfStrings.splice(0,1);target=arrayOfStrings.join('.')}if(source===currentSite&&target!==currentSite){if(!visitedSites[currentSite].hasOwnProperty(target)){dataSent+=3;visitedSites[currentSite][target]=dataSent}}}}console.log('Third party sites by visited site: ',visitedSites)}function updateSideBar(pathElement){if(sidePanel.classList.contains('hidden')){sidePanel.classList.remove('hidden')}if(!prevPathElement){prevPathElement=pathElement}else if(prevPathElement!==pathElement){prevPathElement.classList.remove('active');prevPathElement=pathElement}let thirdPartySite=pathElement.textContent;thirdPartySpan.innerText=thirdPartySite;thirdPartyAboutSpan.innerText=thirdPartySite;let parentSVG=pathElement.nearestViewportElement;let siblingElement=parentSVG.nextElementSibling;let visitedSite=siblingElement.getAttribute('title');visitedSiteSpan.innerText=visitedSite;dataSentSpan.innerText=visitedSites[visitedSite][thirdPartySite];pathElement.classList.add('active');window.scrollTo(0,10000)}}window.onload=lightbeamVis;